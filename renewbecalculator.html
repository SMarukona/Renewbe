<script>

const stepCount = 10;

const steps = Array.from({ length: stepCount }, (_, index) => document.getElementById(`step${index + 1}`));
const backs = Array.from({ length: stepCount - 1 }, (_, index) => document.getElementById(`back${index + 2}`));
const nextButtons = Array.from({ length: stepCount - 1 }, (_, index) => document.getElementById(`next${index + 1}`));

// Define a named function for the next button click event
function handleNextClick(stepIndex) {
  steps[stepIndex].classList.add('more_left');
  steps[stepIndex + 1].classList.remove('more_right');
}

// Add click event listeners for next buttons
for (let stepIndex = 0; stepIndex < stepCount - 1; stepIndex++) {
  nextButtons[stepIndex].addEventListener('click', () => {
    if (!rentRadio.checked && !otherSlopeRadio.checked && !caneRadio.checked) {
      handleNextClick(stepIndex);
    }
  });

  backs[stepIndex].addEventListener('click', () => {
    steps[stepIndex].classList.remove('more_left');
    steps[stepIndex + 1].classList.add('more_right');
  });
}

// Step1 warning text
const propertyRadioGroup = document.getElementsByName('property');
const warningTextStep1 = document.getElementById('w_step1');

const rentRadio = document.getElementById('rent');
const ownerRadio = document.getElementById('owner-2');

propertyRadioGroup.forEach(radio => {
  radio.addEventListener("change", () => {
    if (rentRadio.checked) {
      warningTextStep1.style.display = "block";
      nextButtons[0].classList.add("disabled");
      nextButtons[0].removeEventListener('click', handleNextClick);
    } else {
      warningTextStep1.style.display = "none";
      nextButtons[0].classList.remove("disabled");
      nextButtons[0].addEventListener('click', () => {
        if (!rentRadio.checked) {
          handleNextClick(0);
        }
      });
    }
  });
});

// Step2 warning text
const slopeRadioGroup = document.getElementsByName('slope');
const flatRoofText = document.getElementById('flat_roof-text');
const otherRoofText = document.getElementById('other_roof-text');

const flatRadio = document.getElementById('flat');
const weakSlopeRadio = document.getElementById('weak_slope');
const strongSlopeRadio = document.getElementById('strong_slope');
const otherSlopeRadio = document.getElementById('other_slopes');

slopeRadioGroup.forEach(radio => {
  radio.addEventListener("change", () => {
    if (otherSlopeRadio.checked) {
      otherRoofText.style.display = "block";
      flatRoofText.style.display = "none";
      nextButtons[1].classList.add("disabled");
      nextButtons[1].removeEventListener('click', handleNextClick);
    } else if (flatRadio.checked) {
      flatRoofText.style.display = "block";
      otherRoofText.style.display = "none";
    } else {
      otherRoofText.style.display = "none";
      flatRoofText.style.display = "none";
      nextButtons[1].classList.remove("disabled");
      nextButtons[1].addEventListener('click', () => {
        if (!otherSlopeRadio.checked) {
          handleNextClick(1);
        }
      });
    }
  });
});

const materiialRadioGroup = document.getElementsByName('material');
const roofMaterialText = document.getElementById('roof_material-text');

const caneRadio = document.getElementById('cane');

materiialRadioGroup.forEach(radio => {
  radio.addEventListener("change", () => {
    if (caneRadio.checked) {
      roofMaterialText.style.display = "block";
      nextButtons[2].classList.add("disabled");
      nextButtons[2].removeEventListener('click', handleNextClick);
    } else {
      roofMaterialText.style.display = "none";
      nextButtons[2].classList.remove("disabled");
      nextButtons[2].addEventListener('click', () => {
        if (!caneRadio.checked) {
          handleNextClick(2);
        }
      });
    }
  });
});


const floorCountRadioGroup = document.getElementsByName('floorcount');
const floorCountText = document.getElementById('prop_count-text');

const count2MoreRadio = document.getElementById('count2more');

floorCountRadioGroup.forEach(radio => {
  radio.addEventListener("change", () => {
    if (count2MoreRadio.checked) {
      floorCountText.style.display = "block";
      
      
    } else {
      floorCountText.style.display = "none";
    }
  });
});

const usageCheckbox = document.getElementById('usage_checkbox');
const noOfUserCon = document.getElementById('noofuers_con');

usageCheckbox.addEventListener('change', function() {
  if (usageCheckbox.checked) {
    noOfUserCon.style.display = 'block';
  } else {
    noOfUserCon.style.display = 'none';
  }
});

// Orientation
let selectedOrientation = "";
let capacity = 0; // Initialize the capacity variable

const orientationRadioButtons = document.getElementsByName("orientation");
for (let i = 0; i < orientationRadioButtons.length; i++) {
    orientationRadioButtons[i].addEventListener("change", function() {
        selectedOrientation = orientationRadioButtons[i].value;
        capacity = getCapacityFromOrientation(selectedOrientation);
        console.log("Selected Orientation: " + selectedOrientation);
        console.log("Capacity: " + capacity);
    });
}
function getCapacityFromOrientation(orientation) {
    switch (orientation) {
        case "north":
            return 0.6;
        case "south":
            return 0.95;
        case "east":
            return 0.8;
        case "west":
            return 0.8;
        default:
            return 0; 
    }
}


// Installation Additional cost
let selectedFloorCount = "";
let arialPlatformCost = 0; // Initialize the arialPlatformCost variable

const floorCountRadioButtons = document.getElementsByName("floorcount");
for (let i = 0; i < floorCountRadioButtons.length; i++) {
    floorCountRadioButtons[i].addEventListener("change", function() {
        selectedFloorCount = floorCountRadioButtons[i].value;
        arialPlatformCost = getarielPlatformCostfromFloorCount(selectedFloorCount);
        console.log("Selected Floor Count: " + selectedFloorCount);
        console.log("Aerial Plaform Cost: " + arialPlatformCost);
    });
}
function getarielPlatformCostfromFloorCount(floorcount) {
    switch (floorcount) {
        case "count1":
            return 0;
        case "count2":
            return 0;
        case "count2more":
            return 500;
        default:
            return 0; 
    }
};

const slider1 = document.getElementById('range1');
const slider1Output = document.getElementById('value1');
let selectedYear = "";
let yearlyUsage = 1000; 

slider1.addEventListener('input', function (e) {
  slider1Output.textContent = e.target.value;
  yearlyUsage = parseFloat(e.target.value); // Update yearlyUsage
  const discount = getGovDiscount(selectedYear, yearlyUsage);
  console.log("Discount: $" + discount); // Log the discount value
});

// Gov Discount
const YearRadioButtons = document.getElementsByName("discount");

for (let i = 0; i < YearRadioButtons.length; i++) {
  YearRadioButtons[i].addEventListener("change", function () {
    selectedYear = YearRadioButtons[i].value;
    console.log("Selected Year: " + selectedYear);
    yearlyUsage = parseFloat(slider1.value); // Update yearlyUsage
    const discount = getGovDiscount(selectedYear, yearlyUsage);
    console.log("Discount: $" + discount); // Log the discount value
  });
}

function getGovDiscount(selectedYear, yearlyUsage) {
  if (selectedYear === "before_2014") {
    const discount = (yearlyUsage / 1000) * 150;
    return discount <= 750 ? discount : 750;
  } else if (selectedYear === "after_2014") {
    return 0;
  } else {
    return 0;
  }
}

const yearUsageSubmit = document.getElementById('next8');
yearUsageSubmit.addEventListener('click', function () {
  const yearlyUsage = parseFloat(slider1.value);
  const discount = getGovDiscount(selectedYear, yearlyUsage);
  console.log("Discount: $" + discount); // Log the discount value
  // Use 'discount' for any processing or submit actions
});


//Getting Roof type
let selectedRoofType = "";
  const roofTypeRadioButtons = document.getElementsByName("slope");

for (let i = 0; i < roofTypeRadioButtons.length; i++) {
    roofTypeRadioButtons[i].addEventListener("change", function () {
        selectedRoofType = roofTypeRadioButtons[i].value;
        renewBeCalculater(selectedRoofType);
 });
};

//Getting roof is shaded or not
  let selectedShade = "";
  const roofShadeRadioButtons = document.getElementsByName("shade");

  for (let i = 0; i < roofShadeRadioButtons.length; i++) {
    roofShadeRadioButtons[i].addEventListener("change", function () {
        selectedShade = roofShadeRadioButtons[i].value;
        renewBeCalculater(selectedShade);
    });
  };

//Calculate the 
var pannelData = [
    {
        "Amount of Solar Panels": 1,
        "Wattage": 410,
        "Real Wattage": 328,
        "Tilted": { "Micro (x4)": 0, "String": 0 },
        "Flat": { "Micro (x4)": 0, "String": 0 }
    },
    {
        "Amount of Solar Panels": 2,
        "Wattage": 820,
        "Real Wattage": 656,
        "Tilted": { "Micro (x4)": 2366, "String": 1831 },
        "Flat": { "Micro (x4)": 2446, "String": 1853 }
    },
    {
        "Amount of Solar Panels": 3,
        "Wattage": 1230,
        "Real Wattage": 984,
        "Tilted": { "Micro (x4)": 2881, "String": 2292 },
        "Flat": { "Micro (x4)": 2987, "String": 2327 }
    },
    {
        "Amount of Solar Panels": 4,
        "Wattage": 1640,
        "Real Wattage": 1312,
        "Tilted": { "Micro (x4)": 3482, "String": 2753 },
        "Flat": { "Micro (x4)": 3528, "String": 2797 }
    },
    {
        "Amount of Solar Panels": 5,
        "Wattage": 2050,
        "Real Wattage": 1640,
        "Tilted": { "Micro (x4)": 4011, "String": 3214 },
        "Flat": { "Micro (x4)": 4067, "String": 3269 }
    },
    {
        "Amount of Solar Panels": 6,
        "Wattage": 2460,
        "Real Wattage": 1968,
        "Tilted": { "Micro (x4)": 4492, "String": 3626 },
        "Flat": { "Micro (x4)": 4561, "String": 3694 }
    },
    {
        "Amount of Solar Panels": 7,
        "Wattage": 2870,
        "Real Wattage": 2296,
        "Tilted": { "Micro (x4)": 4976, "String": 4039 },
        "Flat": { "Micro (x4)": 5055, "String": 4118 }
    },
    {
        "Amount of Solar Panels": 8,
        "Wattage": 3280,
        "Real Wattage": 2624,
        "Tilted": { "Micro (x4)": 5457, "String": 4452 },
        "Flat": { "Micro (x4)": 5548, "String": 4542 }
    },
    {
        "Amount of Solar Panels": 9,
        "Wattage": 3690,
        "Real Wattage": 2952,
        "Tilted": { "Micro (x4)": 5907, "String": 4864 },
        "Flat": { "Micro (x4)": 6041, "String": 4966 }
    },
    {
        "Amount of Solar Panels": 10,
        "Wattage": 4100,
        "Real Wattage": 3280,
        "Tilted": { "Micro (x4)": 6421, "String": 5278 },
        "Flat": { "Micro (x4)": 6536, "String": 5390 }
    }
];

function renewBeCalculater(selectedRoofType, selectedShade) {
  const capacity = getCapacityFromOrientation(selectedOrientation);
  const noOfPanels = yearlyUsage / (405 * capacity);
  const finalNoOfPanels = Math.round(noOfPanels);
  
  console.log("No of Pannels: "+ finalNoOfPanels + "Roof Type: "+ selectedRoofType + "Is it shaded: " + selectedShade);
    
    const arialPlatformCost = getarielPlatformCostfromFloorCount(selectedFloorCount);
    const discountAmount = getGovDiscount(selectedYear, yearlyUsage);

    // Pannel installation price
    const installationCost = panelCost + arialPlatformCost - discountAmount;

    //Yearly electrycity price
    const yearlyElectricityCost = yearlyUsage * 0.31; 

    //Payback period
    const payBackPeriod = installationCost/ yearlyElectricityCost;
    const payBackPeriodFinal = Math.round(payBackPeriod);
    const paybackWrapper = document.getElementById('payback_wrapper');
    paybackWrapper.textContent = payBackPeriodFinal;
    
    // Savings in 25 Years
    const savingin25Years = (25 - payBackPeriod)*yearlyElectricityCost;
    const savingin25YearsFinal = Math.round(savingin25Years);
    const savingIn25Years = document.getElementById('25year_saving');
     savingIn25Years.textContent = savingin25YearsFinal.toLocaleString();
     
    const savings = [];

    for (let i = 26; i >= 1; i--) {
     const savingsInYear = (i - payBackPeriod) * yearlyElectricityCost;
     const savingsInYearFinal = Math.round(savingsInYear);
        savings.push({ year: i, savings: savingsInYearFinal });
     }

    console.log("Yearly USage: " + yearlyUsage);
    console.log("No of Pannels: " + finalNoOfPanels);
    console.log("Roof type: " + selectedRoofType);
    console.log("discount amout: " + discountAmount);
    console.log("Total pannel installation cost:" + installationCost);
    console.log("Year electricity cost: " + yearlyElectricityCost);
    console.log("Payback period: " + payBackPeriodFinal);
    console.log("Savings in 25 Years: " + savingin25YearsFinal);
    console.log("Savings over the 25 year period: " + savings);
    
   
}

const lasSubmit = document.getElementById('next9');
lasSubmit.addEventListener("click", renewBeCalculater);



</script>